<script>
  
  function addMessageRow(msg) {
    $("#messages").append(`<div><span class='eventTime'>[${msg.timestamp}]</span> ${msg.text}</div>`);
    if($("#messages div").length > 10) {
      $("#messages").find("div:first").remove();
    }
    $("#messages").scrollTop($("#messages")[0].scrollHeight);
  }

  require('electron').ipcRenderer.on("OCRError", (event) => {
    alert("Error getting area info from screenshot. Please try again");
  });

  require('electron').ipcRenderer.on("message", (event, msg) => {
    addMessageRow(msg);
  });
  
  $("document").ready(() => {
    
    const opn = require('opn');
    $(document).on("click", "a.opn-link", (event) => {
      var target = "" + event.target;
      event.preventDefault();      
      opn(target);      
    });
    
    $("#messages").hover(
      () => { 
        $("#messages").css('height', 'auto') 
      },
      () => { 
        $("#messages").css('height', '40px');
        $("#messages").scrollTop($("#messages")[0].scrollHeight);
      }
    );
    var messages = remote.getGlobal("messages");
    for(var i = 0; i < messages.length; i++) {
      addMessageRow(messages[i]);
    }
    $("#messages").scrollTop($("#messages")[0].scrollHeight);
  });
  
</script>


